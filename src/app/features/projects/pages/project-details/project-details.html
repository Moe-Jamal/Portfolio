@if (isLoading()) {
<!-- Loading State -->
<div class="min-h-screen bg-[#0d0d0d] flex flex-col items-center justify-center p-4">
  <div class="relative w-20 h-20 mb-6">
    <div class="absolute inset-0 border-4 border-primary/20 rounded-full"></div>
    <div
      class="absolute inset-0 border-4 border-primary border-t-transparent rounded-full animate-spin"
    ></div>
  </div>
  <div class="animate-pulse flex flex-col items-center gap-2">
    <span class="text-white text-xl font-bold tracking-wider uppercase">Loading</span>
    <span class="text-[#8B949E] text-sm">Fetching project details...</span>
  </div>
</div>
} @else if (project(); as p) {
<section class="project-details pt-navbar-height pb-20 min-h-screen text-white overflow-hidden">
  <div class="container px-4 mx-auto">
    <!-- Back Button -->
    <button
      class="text-center w-28 rounded-xl h-12 relative text-black font-semibold group mb-6"
      [style.backgroundColor]="p.primaryColor + '10'"
      [style.borderColor]="p.primaryColor + '40'"
      [style.color]="p.primaryColor"
      type="button"
    >
      <a [routerLink]="['/projects']">
        <div
          [style.backgroundColor]="p.primaryColor"
          class="rounded-lg h-10 w-[32px] flex items-center justify-center absolute left-1 top-[4px] group-hover:w-[104px] z-10 duration-500"
        >
          <lucide-icon [img]="MoveLeft" class="w-5 h-5 text-black"></lucide-icon>
        </div>
        <p class="translate-x-3 text-lg">Back</p></a
      >
    </button>
    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start mb-20">
      <!-- Project Preview Image -->
      <div
        class="relative h-full min-h-[350px] flex items-center rounded-[22px] justify-center isolate overflow-hidden"
      >
        <div
          class="absolute inset-0 bg-[url('/images/project-card-bg.png')] bg-cover bg-center bg-no-repeat"
        ></div>
        <div [style.backgroundColor]="p.primaryColor" class="absolute inset-0 mix-blend-hue"></div>
        <img
          src="{{ p.imageUrl }}"
          alt="{{ p.title }}"
          class="w-[calc(100%-40px)] h-[calc(100%-40px)] rounded-xl z-10 object-cover"
        />
      </div>

      <!-- Project Info -->
      <div class="flex flex-col gap-4">
        <div class="flex flex-col gap-2">
          <h1 class="text-5xl sm:text-6xl font-black tracking-tight">{{ p.title }}</h1>
          <p
            [style.color]="p.primaryColor"
            class="text-xl font-bold uppercase tracking-widest italic"
          >
            {{ p.subTitle }}
          </p>
        </div>

        <p class="text-[#8B949E] text-lg leading-relaxed max-w-xl">
          {{ p.description }}
        </p>

        <!-- Tech Stack -->
        <div class="flex flex-col gap-4">
          <h3 class="text-xl font-bold">Tech Stack</h3>
          <ul class="flex flex-wrap gap-4">
            @for (tech of p.technologies; track tech) {
            <li class="group/tech relative">
              @if (getIconComponent(tech); as component) {
              <ng-container *ngComponentOutlet="component" />
              <!-- Tooltip -->
              <span
                class="absolute -bottom-8 left-1/2 -translate-x-1/2 px-2 py-1 rounded bg-black text-xs text-white opacity-0 group-hover/tech:opacity-100 transition-opacity pointer-events-none whitespace-nowrap"
              >
                {{ tech }}
              </span>
              }
            </li>
            }
          </ul>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-wrap gap-4 pt-5">
          @if (p.demoLink) {
          <a
            [href]="p.demoLink"
            target="_blank"
            class="flex items-center gap-3 sm:px-6 px-4 py-4 rounded-xl font-bold text-black transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] shadow-lg"
            [style.backgroundColor]="p.primaryColor"
          >
            <lucide-icon [img]="Monitor" class="w-5 h-5"></lucide-icon>
            <span>View Demo</span>
          </a>
          } @if (p.github) {
          <a
            [href]="p.github"
            target="_blank"
            class="flex items-center gap-3 px-8 py-4 rounded-xl font-bold transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] border shadow-lg"
            [style.backgroundColor]="p.primaryColor + '10'"
            [style.borderColor]="p.primaryColor + '40'"
            [style.color]="p.primaryColor"
          >
            <lucide-icon [img]="Github" class="w-5 h-5"></lucide-icon>
            <span>GitHub</span>
          </a>
          }
        </div>
      </div>
    </div>

    <!-- Main Features Section -->
    @if (p.features && p.features.length > 0) {
    <div class="rounded-3xl bg-footer border border-white/5 p-8 sm:p-12 relative overflow-hidden">
      <!-- Background Glow -->
      <div
        [style.backgroundColor]="p.primaryColor"
        class="absolute -bottom-20 -right-20 w-80 h-80 rounded-full blur-[120px] opacity-10"
      ></div>

      <h2
        [style.color]="p.primaryColor"
        class="text-4xl font-black mb-8 border-l-4 pl-6"
        [style.borderColor]="p.primaryColor"
      >
        Main Features
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8">
        @for (feature of p.features; track feature.title) {
        <div class="flex gap-4">
          <div
            class="mt-1.5 shrink-0 w-2 h-2 rounded-full"
            [style.backgroundColor]="p.primaryColor"
          ></div>
          <div>
            <h4 class="text-xl font-bold text-white mb-1">{{ feature.title }}:</h4>
            <p class="text-[#8B949E] leading-relaxed">
              {{ feature.description }}
            </p>
          </div>
        </div>
        }
      </div>
    </div>
    }
  </div>
</section>
} @else {
<!-- Not Found State -->
<div class="min-h-screen flex flex-col items-center justify-center p-4">
  <div class="text-primary mb-6">
    <lucide-icon [img]="AlertCircle" class="w-20 h-20 opacity-60 animate-pulse"></lucide-icon>
  </div>
  <h2 class="text-3xl font-black text-white mb-2">Project Not Found</h2>
  <p class="text-[#8B949E] mb-8 text-center max-w-md">
    The project you are looking for doesn't exist or has been moved.
  </p>
  <a
    [routerLink]="['/projects']"
    class="flex items-center gap-2 px-6 py-3 rounded-xl bg-primary text-white font-bold transition-all hover:scale-105"
  >
    <lucide-icon [img]="MoveLeft" class="w-5 h-5"></lucide-icon>
    <span>Back to Projects</span>
  </a>
</div>
}
